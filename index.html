<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Portafolio 3D / AR - Angel Alejandro</title>

  <!-- A-Frame -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <!-- AR.js para markerless AR -->
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>

  <!-- Componentes y estilos -->
  <script src="js/components.js"></script>
  <link rel="stylesheet" href="css/styles.css">
  
  <style>
    body { margin: 0; overflow: hidden; }
    #menu-container {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      display: flex; flex-direction: column; justify-content: center; align-items: center;
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      z-index: 10;
      transition: opacity 1s ease;
    }
    #menu-container.hidden { opacity: 0; pointer-events: none; }
    .menu-title { color: #FFD93D; font-size: 2em; margin-bottom: 1rem; }
    .menu-button {
      margin: 0.5rem; padding: 1rem 2rem; font-size: 1.2rem;
      border: none; border-radius: 12px; cursor: pointer;
      background: #FFD93D; color: #1e3c72; font-weight: bold;
      transition: transform 0.2s;
    }
    .menu-button:hover { transform: scale(1.1); }
    .menu-note { margin-top: 1rem; color: #FFF; font-size: 0.9rem; text-align: center; }
  </style>
</head>
<body>

  <!-- Men√∫ principal -->
  <div id="menu-container">
    <h1 class="menu-title">Elige tu Experiencia üöÄ</h1>
    <button class="menu-button" onclick="loadScene('desktop')">
      üíª Exploraci√≥n 3D (PC/Rat√≥n)
    </button>
    <button class="menu-button" onclick="loadScene('mobile')">
      üì± Exploraci√≥n 3D (Giroscopio/T√°ctil)
    </button>
    <button class="menu-button" onclick="loadScene('ar')">
      üñºÔ∏è Realidad Aumentada (AR)
    </button>
    <p class="menu-note">
      *AR requiere Chrome/Safari actualizado y permisos de c√°mara.
    </p>
  </div>

  <!-- Contenedor de la escena -->
  <div id="scene-container"></div>

  <script>
    let currentScene = null;

    function loadScene(mode) {
      const menu = document.getElementById('menu-container');
      const sceneContainer = document.getElementById('scene-container');

      // Ocultar men√∫
      menu.classList.add('hidden');
      setTimeout(() => { menu.style.display = 'none'; }, 1000);

      // Limpiar escena anterior
      if (currentScene) {
        currentScene.remove();
        currentScene = null;
      }
      sceneContainer.innerHTML = '';

      // Crear nueva escena
      const scene = document.createElement('a-scene');
      currentScene = scene;

      // Configuraci√≥n base
      scene.setAttribute('shadow', 'type: pcfsoft');
      scene.setAttribute('vr-mode-ui', 'enabled: true');
      scene.setAttribute('embedded', mode !== 'ar'); // AR fullscreen
      scene.setAttribute('background', 'color: #1e3c72');

      let cameraContent = '';
      let sceneContent = '';

      // C√°mara y controles
      if (mode === 'desktop') {
        cameraContent = `<a-entity camera look-controls wasd-controls position="0 1.6 6">
                           <a-cursor raycaster="objects: .clickable" color="#FFD93D" fuse="true" fuse-timeout="1500"></a-cursor>
                         </a-entity>`;
      } else if (mode === 'mobile') {
        cameraContent = `<a-entity camera look-controls touch-controls position="0 1.6 6">
                           <a-cursor raycaster="objects: .clickable" color="#FFD93D" fuse="true" fuse-timeout="1500"></a-cursor>
                         </a-entity>`;
      } else if (mode === 'ar') {
        // Modo AR markerless
        scene.setAttribute('arjs', 'sourceType: webcam; debugUIEnabled: false; trackingMethod: best;');
        scene.removeAttribute('embedded');

        cameraContent = `<a-entity camera></a-entity>`;

        sceneContent = `
          ${cameraContent}

          <a-light type="ambient" color="#FFF5E1" intensity="0.7"></a-light>

          <!-- Modelos flotando frente al usuario -->
          <a-entity gltf-model="url(assets/guitarra.glb)" position="0 0 -2" rotation="0 30 0" scale="0.5 0.5 0.5"
                    animation="property: rotation; to: 0 390 0; loop: true; dur: 15000; easing: linear;"></a-entity>

          <a-entity gltf-model="url(assets/laptop.glb)" position="1 0 -2.5" rotation="0 -20 0" scale="0.4 0.4 0.4"
                    animation="property: rotation; to: 0 340 0; loop: true; dur: 14000; easing: linear;"></a-entity>

          <a-text value="üìå Mueve el celular para ver los modelos en AR"
                  position="0 0.1 -1.5" align="center" color="#FFD93D" width="2.5"></a-text>
        `;
      }

      // Contenido para Desktop / Mobile
      if (mode !== 'ar') {
        sceneContent = `
          <a-light type="ambient" color="#FFF5E1" intensity="0.7"></a-light>
          <a-light type="point" position="0 2 -2" color="#FFD93D" intensity="1.2" distance="8" decay="2"></a-light>
          <a-light type="point" position="2 1 -1" color="#6EC1E4" intensity="0.8" distance="5" decay="2"></a-light>

          ${cameraContent}

          <a-plane position="0 0 0" rotation="-90 0 0" width="16" height="16" color="#2d2d40" shadow="receive: true"></a-plane>

          <a-box position="0 2 -8" depth="0.1" height="4" width="16" color="#3b3b5c"></a-box>
          <a-box position="-8 2 0" depth="16" height="4" width="0.1" color="#4a4a6a"></a-box>
          <a-box position="8 2 0" depth="16" height="4" width="0.1" color="#4a4a6a"></a-box>
          <a-box position="0 4 0" depth="16" height="0.1" width="16" color="#55557a"></a-box>

          <a-entity position="-2 1.7 0" rotation="0 35 0"
                    info-panel="title: üìö Sobre mi; content: Soy un joven apasionado por la programaci√≥n, m√∫sica y creatividad.; color: #2a5298"
                    animation="property: position; to: -2 1.8 0; dir: alternate; loop: true; dur: 2500; easing: easeInOutQuad;"></a-entity>

          <a-entity position="0 1.7 0" rotation="0 0 0"
                    info-panel="title: üéØ Objetivos; content: ‚Ä¢ Convertirme en programador de alto nivel.\\n‚Ä¢ Construir portafolio s√≥lido.\\n‚Ä¢ Crear UBoxHouse; color: #1e3c72"
                    animation="property: position; to: 0 1.9 0; dir: alternate; loop: true; dur: 2800; easing: easeInOutSine;"></a-entity>

          <a-entity position="2 1.7 0" rotation="0 -35 0"
                    info-panel="title: üí° Intereses; content: ‚Ä¢ üéµ M√∫sica: producci√≥n y m√°ster\\n‚Ä¢ üíª Programaci√≥n: Java, Python, C++\\n‚Ä¢ üé¨ Edici√≥n: Photoshop, Premiere; color: #2c5364"
                    animation="property: position; to: 2 1.8 0; dir: alternate; loop: true; dur: 2600; easing: easeInOutQuad;"></a-entity>

          <a-entity gltf-model="url(assets/guitarra.glb)" position="-4 0 -3" rotation="0 30 0" scale="0.1 0.1 0.1" shadow="cast: true"
                    animation="property: rotation; to: 0 390 0; loop: true; dur: 15000; easing: linear;"></a-entity>

          <a-entity gltf-model="url(assets/laptop.glb)" position="4 0 -3" rotation="0 -20 0" scale="0.4 0.4 0.4" shadow="cast: true"
                    animation="property: rotation; to: 0 340 0; loop: true; dur: 14000; easing: linear;"></a-entity>

          <a-text value="¬© 2025 - Creado por Angel Alejandro üöÄ" position="0 0.2 -2.5" align="center" color="#AAA" width="6"></a-text>
        `;
      }

      // Montar la escena
      scene.innerHTML = sceneContent;
      sceneContainer.appendChild(scene);

      // Forzar reproducci√≥n
      scene.addEventListener('loaded', () => scene.play());
    }
  </script>

</body>
</html>
